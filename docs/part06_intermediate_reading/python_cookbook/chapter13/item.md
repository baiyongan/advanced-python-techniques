# 第十三章：脚本编程与系统管理

<!-- -------------------------------------------------------------------------- -->
## 01 通过重定向/管道/文件接受输入

!!! question "问题"
    如何让脚本接受任何用户认为最简单的输入方式。包括将命令行的输出通过管道传递给该脚本、 重定向文件到该脚本，或在命令行中传递一个文件名或文件名列表给该脚本。

    - 使用 Python 内置的 `fileinput` 模块

??? done "解决方案"

    ```python
    #!/usr/bin/env python3
    import fileinput

    with fileinput.input() as f_input:
        for line in f_input:
            print(line, end='')
    ```

    假设将此脚本保存为 `filein.py` 并将其变为可执行文件， 则可以像下面这样调用它，得到期望的输出：

    ```python
    $ ls | ./filein.py          # Prints a directory listing to stdout.
    $ ./filein.py /etc/passwd   # Reads /etc/passwd to stdout.
    $ ./filein.py < /etc/passwd # Reads /etc/passwd to stdout.
    ```

??? summary "讨论"

    `fileinput.input()` 创建并返回一个 `FileInput` 类的实例。该实例除了拥有一些有用的帮助方法外，它**还可被当做一个上下文管理器使用**。
    
    如果我们要写一个打印多个文件输出的脚本，那么我们需要在输出中包含文件名和行号，如下所示

    ```python
    >>> import fileinput
    >>> with fileinput.input('/etc/passwd') as f:
    >>>     for line in f:
    ...         print(f.filename(), f.lineno(), line, end='')
    ...
    /etc/passwd 1 ##
    /etc/passwd 2 # User Database
    /etc/passwd 3 #

    <other output omitted>
    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 02 终止程序并给出错误信息

!!! question "问题"
    如何向标准错误打印一条消息，并返回某个非零状态码来终止程序运行？

    - 在程序中抛出一个 `SystemExit` 异常，使用错误消息作为参数。

??? done "解决方案"

    ```python
    raise SystemExit('It failed!')
    ```

    它会将消息在 `sys.stderr` 中打印，然后程序以状态码 1 退出。

??? summary "讨论"

    当你想要终止某个程序时，你可能会像下面这样写：

    ```python
    import sys
    sys.stderr.write('It failed!\n')
    raise SystemExit(1)
    ```

    如果直接将消息作为参数传给 `SystemExit()` ，那么可以省略其他步骤， 比如 import 语句或将错误消息写入 `sys.stderr`。


<!-- -------------------------------------------------------------------------- -->
## 03 解析命令行选项

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 04 运行时弹出密码输入提示

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 05 获取终端的大小

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```


<!-- -------------------------------------------------------------------------- -->
## 06 执行外部命令并获取它的输出

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 07 复制或者移动文件和目录

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 08 创建和解压归档文件

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 09 通过文件名查找文件

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 10 读取配置文件

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 11 给简单脚本增加日志功能

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 12 给函数库增加日志功能

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 13 实现一个计时器

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 14 限制内存和CPU的使用量

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 15 启动一个WEB浏览器

!!! question "问题"

??? done "解决方案"

    ```python

    ```

    ```python

    ```

??? summary "讨论"

    ```python

    ```

    ```python

    ```

<!-- -------------------------------------------------------------------------- -->
## 总结

!!! example "总结"